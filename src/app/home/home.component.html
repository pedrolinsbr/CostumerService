<div *ngIf="usarHome == 1">

    <ng-template #modalDanfe>
        <div class="modal-header">
            <h3 class="mt-0 mb-0 text-uppercase" style="margin-left: 23px !important;">
                <small class="fw-300">Visualização Danfe</small>
            </h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="color: #464444">
            <div style="width: 100%">
                <div>
                    <app-danfe [IDG083]="IDG083_selecionada"></app-danfe>
                </div>
            </div>
        </div>       
    </ng-template>

    <ng-template #modalDacte>
        <div class="modal-header">
            <h3 class="mt-0 mb-0 text-uppercase" style="margin-left: 23px !important;">
                <small class="fw-300">Visualização Dacte</small>
            </h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body" style="color: #464444">
            <div style="width: 100%">
                <div>
                    <app-dacte [IDG051]="IDG051_selecionada"></app-dacte>
                </div>
            </div>
        </div>       
    </ng-template>

    <ng-template #modalConfirmaRemocao>
        <div class="modal-header">
            <h3 class="mt-0 mb-0 text-uppercase" style="margin-left: 10px !important;"><small class="fw-300"><strong>Atendimento/Ocorrência #{{IDA001_remover}}</strong></small></h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModal()">
			<span aria-hidden="true">&times;</span>
		</button>
        </div>
        <div class="modal-body" style="color: #464444">
            <div class="form-group col-sm-12 col-md-12 col-lg-12">
                <div class="input-group" [formGroup]="objFormRemoveAtendimento">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Motivo da exclusão:</span>
                    </div>
                    <textarea class="form-control" formControlName="DSREMOTI" rows="6" placeholder="Digite aqui o motivo..." aria-label="Motivo da exclusão">
				</textarea>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success" (click)="removerAtendimento()">Remover</button>
            <button type="button" class="btn btn-danger" (click)="closeModal()">Cancelar</button>
        </div>
        <ngx-loading [show]="loadingModalAtendimento"></ngx-loading>
    </ng-template>

    <app-breadcrumbs #breadcrumbs home="Home" [arBreadcrumbs]="arBreadcrumbsLocal" (goHome)="voltar()" (clearNext)="clearNext($event)" [context]="this" backgroundColor="#d5e0e4">
    </app-breadcrumbs>

    <div class="main-content" *ngIf="exibir == 1" style="padding-top: 20px;">

        <app-indicadores-group [objIndicadoresHome]="indicadores"></app-indicadores-group>

        <app-cards-filter titleDrop="Filtros" nameSubmitFunction="filtrarHome" nameClearFunction="limparHome" idGrid="gridHomeNFe" [dropdown]="true" advancedOptions="advancedFilter" [isCollapsed]="true" [context]="this">

            <form class="form-horizontal" [formGroup]="objFormFilterHome">
                <!-- Filtros Comuns -->
                <div class="row">
                    <div class="col-sm-3">
                        <label>Data Emissão NF (inicial)</label>

                        <i class="far fa-question-circle" ngbPopover="Informe o início do periodo a pesquisar." container="body" triggers="mouseenter:mouseleave"></i>

                        <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [dataSelecionada]='dtInicioDefault' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'DTINICIO'"
                            (dataClicada)="dataClick($event)">
                        </app-datapicker-popup>
                    </div>
                    <div class="col-sm-3">
                        <label>Data Emissão NF (final)</label>
                        <i class="far fa-question-circle" ngbPopover="Informe o fim do periodo a pesquisar." container="body" triggers="mouseenter:mouseleave"></i>
                        <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [dataSelecionada]='dtTerminoDefault' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'DTFIM'"
                            (dataClicada)="dataClick($event)">
                        </app-datapicker-popup>
                    </div>
                    <div class="form-group col-sm-2 col-md-2 col-lg-2" [formGroup]="objFormFilterH">
                        <label for="">Notas Entregues</label>
                        <select class="form-control" id="G043_DTENTREG" name="G043_DTENTREG" formControlName="G043_DTENTREG">
						<option value="2" [selected]="selected1">Todos</option>
						<option value="{{item.value}}" *ngFor="let item of global.arDtEntreg">{{item.text}}</option>
					    </select>
                    </div>


                    <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                        <label for="">Logística</label>
                        <i class="far fa-question-circle" ngbPopover="Tipo de logística aplicada." container="body" triggers="mouseenter:mouseleave"></i>
                        <select class="form-control" id="TPOPERAC" name="TPOPERAC" formControlName="TPOPERAC">
						<option value="3" [selected]="selected8">Todos</option>
						<option value="1">3PL</option>
						<option value="2">4PL</option>
					</select>
                    </div>

                    <div class="form-group col-sm-2">
                        <label for="">Tipo de Operação</label>
                        <i class="far fa-question-circle" ngbPopover="Informe o tipo de operação do CTE." container="body" triggers="mouseenter:mouseleave"></i>
                        <app-combobox-multi [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]="false" [formControlNameMultiSelect]="'G051_TPTRANSP'" [comboFix]="'tipoDeOperacaoHomeMonitoria'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G051_TPTRANSP">
                        </app-combobox-multi>
                    </div>
                </div>
                <div *ngIf="!advancedFilter">
                    <div class="row">
                        <div class="col-sm-3">
                            <label>Data Agendada</label>

                            <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'G051_DTAGENDA'" (dataClicada)="dataClick($event)">
                            </app-datapicker-popup>
                        </div>
                        <div class="col-sm-3">
                            <label>Data Prevista</label>
                            <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'DTPREENT'" (dataClicada)="dataClick($event)">
                            </app-datapicker-popup>
                        </div>

                        <div class="col-sm-3">
                            <label>Data de Entrega (inicial)</label>
                            <i class="far fa-question-circle" ngbPopover="Informe a data de entrega inicial para a pesquisar." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'DTENTREG0'" (dataClicada)="dataClick($event)">
                            </app-datapicker-popup>
                        </div>
                        <div class="col-sm-3">
                            <label>Data de Entrega (final)</label>
                            <i class="far fa-question-circle" ngbPopover="Informe a data de entrega final para a pesquisar." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-datapicker-popup navegacao='select' [outsideDays]='visible' [dataMinima]='dataMinima' [dataMaxima]='dataMaxima' [mesesDisplay]='1' [desabilitar]='false' [formDatePop]="objFormFilterH" [formControlNameDatePop]="'DTENTREG1'" (dataClicada)="dataClick($event)">
                            </app-datapicker-popup>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-sm-6">
                        <label>Número da NF-e</label>
                        <app-chips-input [typeInput]="'numberText'" [chips]='arIdNfe' [removable]='true' [addOnBlur]='true' [duplicate]='false' [objStyle]="objStyle" [inputSpace]='true'>
                        </app-chips-input>
                    </div>
                    <div class="form-group col-sm-6">
                        <label>Número do CT-e</label>
                        <app-chips-input [typeInput]="'numberText'" [chips]='arIdCte' [removable]='true' [addOnBlur]='true' [duplicate]='false' [objStyle]="objStyle" [inputSpace]='true'>
                        </app-chips-input>
                    </div>
                </div>
                <div *ngIf="!advancedFilter">
                    <div class="row">
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label for="NMCIDADE">Transportadora - Carga</label>
                            <i class="far fa-question-circle" ngbPopover="Transportadora onde a carga está sendo transportada." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/transportadoras'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G046_IDG024'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G046_IDG024">
                            </app-combobox-multi>
                        </div>
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label for="NMCIDADE">Transportadora - CTe</label>
                            <i class="far fa-question-circle" ngbPopover="Transportadora/Filial emitente do CTE." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/transportadoras'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G051_IDG024'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G051_IDG024">
                            </app-combobox-multi>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label for="NMCIDADE">Remetente</label>
                            <i class="far fa-question-circle" ngbPopover="Remetente na NF/Delivery." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/clientes'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G043_IDG005RE'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G043_IDG005RE" [showInfo]="showCDUF">
                            </app-combobox-multi>
                        </div>
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label for="NMCIDADE">Remetente do CTE</label>
                            <i class="far fa-question-circle" ngbPopover="Remetente no CTE." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/clientes'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G051_IDG005RE'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G051_IDG005RE" [showInfo]="showCDUF">
                            </app-combobox-multi>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label>Destinatário</label>
                            <i class="far fa-question-circle" ngbPopover="Destinatário da carga." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/clientes'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G043_IDG005DE'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G043_IDG005DE">
                            </app-combobox-multi>
                        </div>
                        <div class="form-group col-sm-6 col-md-6 col-lg-6">
                            <label>Tomador</label>
                            <i class="far fa-question-circle" ngbPopover="Tomador da nota." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-combobox-multi [url]="url+'filtro/tomadores'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G051_IDG005CO'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G051_IDG005CO">
                            </app-combobox-multi>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-sm-2">
                            <app-single-numeroViagem [objForm]="objFormFilterH" [formName]="'G046_IDG046'" [haveCTE]="1">
                            </app-single-numeroViagem>
                        </div>
                        <div class="form-group col-sm-4">
                            <label>Carga Logos</label>
                            <i class="far fa-question-circle" ngbPopover="Código da carga no sistema Logos." container="body" triggers="mouseenter:mouseleave"></i>
                            <app-chips-input [typeInput]="'numberText'" [chips]='arIdCargaLog' [removable]='true' [addOnBlur]='true' [duplicate]='false' [objStyle]="objStyle" [inputSpace]='true'>
                            </app-chips-input>
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterHome">
                            <label>Código da Delivery</label>
                            <input class="form-control" id="G043_CDDELIVE" name="G043_CDDELIVE" formControlName="G043_CDDELIVE" placeholder="Digite para pesquisar">
                        </div>
                        <div class="form-group col-sm-2 col-md-2 col-lg-2">
                            <label>Nº da Frota</label>
                            <app-combobox-multi [url]="url+'filtro/frota'" [formMultiSelect]="objFormFilterH" [disabledViewMultiSelect]='false' [formControlNameMultiSelect]="'G032_NRFROTA'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G032_NRFROTA">
                            </app-combobox-multi>
                            <!-- [showInfo] = "showCDUF"-->
                        </div>
                        <div class="form-group col-sm-2 col-md-2 col-lg-2">
                            <app-combobox-multi label="Veículos" [url]="url+'filtro/buscarDescVeiculos'" [formMultiSelect]="objFormFilterH" [formControlNameMultiSelect]="'G032_IDG032'" [auxGoBack]="auxGoHome" [valSelected]="objAux.G032_IDG032">
                            </app-combobox-multi>
                        </div>

                    </div>
                    <div class="row">
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterHome">
                            <label>Número do Atendimento</label>
                            <i class="far fa-question-circle" ngbPopover="Filtrar por número de atendimento." container="body" triggers="mouseenter:mouseleave"></i>
                            <input class="form-control" id="A005_IDA001" name="A005_IDA001" formControlName="A005_IDA001" placeholder="Digite para pesquisar">
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                            <label for="">Ação</label>
                            <select class="form-control" formControlName="A002_IDA008" id="A002_IDA008" name="A002_IDA008">
							<option value="0" [selected]="selected5">Todos</option>
							<option value="1">Atendimento</option>
							<option value="2">Ocorrência</option>
						</select>
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                            <label for="">Situação Notas</label>
                            <select class="form-control" id="G043_DTBLOQUE" name="G043_DTBLOQUE" formControlName="G043_DTBLOQUE">
							<option value="2" [selected]="selected6">Todos</option>
							<option value="1">Bloqueadas</option>
							<option value="0">Desbloqueadas</option>
						</select>
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                            <label for="">Operação AG</label>
                            <i class="far fa-question-circle" ngbPopover="Indique se é nota de AG (Armazem Geral)." container="body" triggers="mouseenter:mouseleave"></i>
                            <select class="form-control" formControlName="G043_SNAG" id="G043_SNAG" name="G043_SNAG">
							<option value="2" [selected]="selected3">Todos</option>
							<option value="{{item.value}}" *ngFor="let item of global.arSnAgNf">{{item.text}}</option>
						</select>
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                            <label for="">Situação CT-e</label>
                            <select class="form-control" formControlName="G051_STCTRC" id="G051_STCTRC" name="G051_STCTRC">
							<option value="N" >Todos</option>
							<option value="A" [selected]="selected4">Ativos</option>
							<option value="C">Cancelados</option>
						</select>
                        </div>
                        <div class="form-group col-sm-2" [formGroup]="objFormFilterH">
                            <label for="">QM Motivos</label>
                            <select class="form-control" id="G051_IDI015" name="G051_IDI015" formControlName="G051_IDI015">
							<option value="2" [selected]="selected7">Todos</option>
							<option value="1">Sim</option>
							<option value="0">Não</option>
						</select>
                        </div>
                    </div>
                </div>
            </form>
        </app-cards-filter>

        <app-cards titleDrop="Registros" idGrid="gridHomeDados" [isCollapsed]="collapsed" [dropdown]="true" *ngIf="usarHome == 1"  >
            <!-- class="fixed-tops"-->
            <app-datagrid #dgNotasFiscaisHome 
            [id]="'listarNotasFiscaisHome'" 
            [url]="url+'mo/deliverynf/listar'" 
            [tela]="42" 
            [order]="[7, 'desc']" 
            [telaGlobal]="[ {'id' : 'excel'},
				{'id' : 'colvis'} ]" [telaAcoes]="[
				{'id' : 1,  'metodo' : 'visualizarNota',   'icone': 'fa fa-eye'},
				{'id' : 65,  'metodo' : 'inserirMotivo',   'icone': 'fas fa-edit'},
                {'id' : 68,  'metodo' : 'criarNovoAtendimento',   'icone': 'fas fa-edit'},
                {'id' : 95,  'metodo' : 'imprimirDanfe', 'icone': 'fas fa-print'},
                {'id' : 96,  'metodo' : 'imprimirDacte', 'icone': 'fas fa-print'}]" 
            [nivel]="0" 
            [thisParent]="this" 
            [allList]="true" 
            [notOnLoad]="true" 
            [stateSave]="true" 
            [excelServer]="true"
            [scroll]="500">
                <th data-id="IDG043" data-object="true" data-type-column="actions">Ações</th>
                <th data-id="NRNOTA" data-align-right="true" data-exec="openModalAtendimento">Nº NF</th>
                <th data-id="G051_CDCTRC" data-align-right="true">Nº CTe</th>
                <th data-id="G024CTE_NMTRANSP" data-align-left="true">Transportadora - CTe</th>
                <th data-id="NMTRANSP_CARGA" data-align-left="true" data-function="validaNullMonitoria">Transportadora - Carga</th>
                <th data-id="G005RE_RSCLIENTRE" data-align-left="true">Razão Social - Emissor</th>
                <th data-id="G005DE_RSCLIENTDE" data-align-left="true">Razão Social - Destino</th>
                <th data-id="DTEMINOT" data-align-center="true">Data Emissão NF</th>
                <th data-id="DTCOLETA" data-align-center="true">Data Coleta</th>
                <th data-id="IDG043" data-function="homeMonitoria" data-function-full="true">Indicadores</th>
                <th data-id="G051_DTPREENT" data-align-center="true">Data Pre. Entrega</th>
                <th data-id="G051_DTEMICTR" data-visible="false">Data Emissão CTe</th>
                <th data-id="DTENTCON" data-align-center="true">Data Ent. SLA</th>
                <th data-id="DTENTREG" data-align-center="true">Data Ent. Realizada</th>
                <th data-id="HRENTREG" data-align-center="true">Horário Ent. Realizada</th>
                <th data-id="DTBLOQUE" data-visible="false">Data de Bloqueio</th>
                <th data-id="DTDESBLO" data-visible="false">Data de Desbloqueio</th>
                <th data-id="G051_DTAGENDA" data-align-center="true">Data Agendada</th>
                <th data-id="G051_DTCOMBIN" data-visible="false">Data Combinada</th>
                <th data-id="G051_DTROTERI" data-visible="false">Data Roteirização</th>
                <th data-id="G005RE_NMCLIENTRE" data-visible="false" data-align-left="true">Nome - Emissor</th>
                <th data-id="G005DE_NMCLIENTDE" data-visible="false" data-align-left="true">Nome - Destino</th>
                <th data-id="G003RE_NMCIDADERE" data-visible="false" data-align-left="true">Cidade do Emissor</th>
                <th data-id="G002RE_NMESTADORE" data-visible="false" data-align-left="true">Estado do Emissor</th>
                <th data-id="G003DE_NMCIDADEDE" data-visible="false" data-align-left="true">Cidade do Destino</th>
                <th data-id="G002DE_NMESTADODE" data-visible="false" data-align-left="true">Estado do Destino</th>
                <th data-id="G005CO_NMCLIENTCO" data-visible="false" data-align-left="true">Tomador</th>
                <th data-id="G051_TPTRANSP" data-align-left="true">Tipo de Operação</th>
                <th data-id="G046_STCARGA" data-align-left="true" data-function="validaNullMonitoria">Status da Carga</th>
                <th data-id="QTD_CANHOTOS" data-align-left="true" data-function="verificaHome">Envio Canhoto</th>
                <th data-id="PRAZO" data-align-right="true" data-function="validaNullMonitoria">Prazo</th>
                <th data-id="SNAG" data-align-left="true" data-function="validaAgMonitoria" data-function-full="true">Retorno AG</th>
                <th data-id="IDG043_REC" data-align-left="true"  data-function-full="true">Recusada</th>
                <th data-id="DSOBSERV_BLOQ" data-visible="false" data-function="validaNullMonitoria" data-align-left="true">Descrição Atendimento Bloq.</th>

                <!-- <th data-id="G024_NMTRANSP" data-align-left="true">Transportadora Carga</th>
			<th data-id="G046_IDG046" data-visible="false" data-align-right="true" >Carga</th> -->

            </app-datagrid>
        </app-cards>
    </div>

    <!--
Exibir = 2
Atendimentos referentes a NF-e escolhida
-->
    <div *ngIf="exibir == 2 && modalAtendimento == false">
        <div class="row">
            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">

                <app-cards titleDrop="Listagem de atendimentos" [isCollapsed]="gridVazia" [dropdown]="true">

                    <app-datagrid [id]="'gridAtendimentosCriados'" [url]="url+'mo/atendimentos/listarByNfe'" [tela]="42" [telaGlobal]="
						[
							{'id' : 24,'metodo' : 'criarAtendimento',      'icone': 'fa fa-plus'},
							{'id' : 'colvis'}
						]" [telaAcoes]="arrayBotoes" [nivel]="0" [thisParent]="this" [notOnLoad]="true" [initComplete]="'filtrarAtendimentoByNfe'" (respostaFilho)="recebeEmit($event)" [scroll]="500">
                        <th data-id="IDA001" data-type-column="actions">Ações</th>
                        <th data-id="IDA001" data-align-right="true">Id</th>
                        <th data-id="NUMNOTA" data-align-right="true" data-function="controlViewGrid" data-function-full="true">Nº NF</th>
                        <th data-id="A008_DSACAO" data-align-left="true">Ação</th>
                        <th data-id="S001_NMUSUARI" data-align-left="true">Atendente</th>
                        <th data-id="A002_DSTPMOTI" data-align-left="true">Título</th>
                        <th data-id="A006_DSSITUAC" data-align-left="true">Situação</th>
                        <th data-id="DTREGIST">Abertura</th>
                        <th data-id="DTFIM">Fechamento</th>
                        <th data-id="TEMPO">Tempo</th>
                    </app-datagrid>
                </app-cards>

                <br />

                <app-cards titleDrop="Informações" [isCollapsed]="collapsed" [dropdown]="true">

                    <!-- <button
					type="button"
					class="btn btn-primary btn-block"
					(click)="envioSatisfacao();">
					<i class="fas fa-share-alt"></i> &nbsp; Satisfação
				</button> -->

                    <ngx-loading [show]="loading"></ngx-loading>

                    <app-info-rastreio #componentRastreio [validaMilestone]="objValidaMilestone" [objRastreio]="rastreioObj" resumido="true" [validaHome]="true" [numNF]="numNF" [syngenta]="validSyngenta" [arCanhoto]="arCanhoto"></app-info-rastreio>

                    <div class="row" *ngIf="SNADMIN == 1">
                        <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                            <fieldset class="scheduler-border">
                                <legend class="scheduler-border" style="background-color:SlateGray !important;">Datas - Visão Administrativa</legend>
                                <div class="row auxRow">
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Emissão NF-e:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTEMINOT ? (DTEMINOT ): ('n.i.') }}
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Emissão CT-e:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTEMICTR ? (DTEMICTR ): ('n.i.') }}
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Roterizada:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTROTERI ? (DTROTERI ): ('n.i.') }}
                                    </div>
                                </div>
                                <div class="row separator"></div>
                                <div class="row auxRow">
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Data SLA:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTENTCON ? (DTENTCON ): ('n.i.') }} <br /><small *ngIf="previsao4" class="text-info">Previsão de entrega atual</small>
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Entrega Planejada:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTENTPLA ? (DTENTPLA): ('n.i.') }} <br /><small *ngIf="previsao3" class="text-info">Previsão de entrega atual</small>
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Calculada pelo Logos:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTCALDEP ? (DTCALDEP ): ('n.i.') }} <br /><small *ngIf="previsao5" class="text-info">Previsão de entrega atual</small>
                                    </div>
                                </div>
                                <div class="row separator"></div>
                                <div class="row auxRow">
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Agendada:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTAGENDA ? (DTAGENDA ): ('n.i.') }} <br /><small *ngIf="previsao1" class="text-info">Previsão de entrega atual</small>
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Combinada:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTCOMBIN ? (DTCOMBIN ): ('n.i.') }} <br /><small *ngIf="previsao2" class="text-info">Previsão de entrega atual</small>
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Entrega:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTENTREG ? (DTENTREG ): ('n.i.') }} <br /><small *ngIf="markEntrega" class="text-info">Nota já entregue rastreador</small>
                                    </div>
                                </div>
                                <div class="row separator"></div>
                                <div class="row auxRow">
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Entrega Mobile:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTENTMOB ? (DTENTMOB ): ('n.i.') }} <br />
                                        <!-- <small *ngIf="markEntrega" class="text-info">Nota já entregue</small> -->
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
                                        Dt Entrega do Canhoto:
                                    </div>
                                    <div class="col-md-2 col-lg-2 col-xl-2 text-left">
                                        {{ DTCANHOT ? (DTCANHOT ): ('n.i.') }} <br />
                                        <!-- <small *ngIf="markEntrega" class="text-info">Nota já entregue</small> -->
                                    </div>
                                    <!-- <div class="col-md-2 col-lg-2 col-xl-2 text-left font-weight-bold">
									Dt Entrega do Rastreador:
								</div>
								<div class="col-md-2 col-lg-2 col-xl-2 text-left">
									{{ DTENTRAS ? (DTENTRAS ): ('n.i.') }} <br /> -->
                                    <!-- <small *ngIf="markEntrega" class="text-info">Nota já entregue</small> -->
                                    <!-- </div> -->
                                </div>
                            </fieldset>
                        </div>
                    </div>

                    <app-info-nfe [objNotaFiscal]="nfeObj" [IDG083]="IDG083_selecionada" [buttonDanfe]="objButtonDocs.danfeButton"></app-info-nfe>

                    <app-info-cte [objCTE]="cteObj" [IDG051]="IDG051_selecionada" [buttonDacte]="objButtonDocs.dacteButton"></app-info-cte>

                    <app-info-carga [objCarga]="cargaObj"></app-info-carga>

                    <app-info-rastreio-detalhado [objTracking]="trackingObj" [entreg]="entregTracking"></app-info-rastreio-detalhado>

                    <app-envio-rastreio #componenteEnvioRastreio [objEnvioRastreio]="envioRastreioObj" (shareRastreio)="compartilharRastreio($event)" [envSyngenta]="validSyngenta"></app-envio-rastreio>

                    <app-envio-nps #componenteEnvioNps [objEnvioNps]="envioRastreioObj" (shareNps)="enviarSatisfacaoUnico($event)" [envSyngenta]="validSyngenta"></app-envio-nps>
                </app-cards>
            </div>
        </div>
    </div>

    <!--
Exibir = 5
Cadastro de Atendimento
 -->
    <div *ngIf="exibir == 5 && modalAtendimento == false">

        <app-cards titleDrop="Cadastro de Atendimento" [isCollapsed]="collapsed" [dropdown]="true">

            <app-novo-atendimento (callListAtendimentos)="backToAtendimento()" (movAtendimentoEvent)="movAtendimento($event)" [IDG043]="IDG043_selecionada" [IDG051]="IDG051_selecionada" [IDG046]="IDG046_selecionada" [IDG083]="IDG083_selecionada" [validaSyngenta]="validSyngenta" [ultCarga]="ultCarga_selecionada">
            </app-novo-atendimento>

        </app-cards>

        <app-cards titleDrop="Informações" [isCollapsed]="collapsed" [dropdown]="true">

            <ngx-loading [show]="loading"></ngx-loading>

            <app-info-rastreio #componentRastreio [objRastreio]="rastreioObj" [validaMilestone]="objValidaMilestone" resumido="true" [arCanhoto]="arCanhoto"></app-info-rastreio>

            <app-info-nfe [objNotaFiscal]="nfeObj"></app-info-nfe>

            <app-info-cte [objCTE]="cteObj"></app-info-cte>

            <app-info-carga [objCarga]="cargaObj"></app-info-carga>

            <app-info-rastreio-detalhado [objTracking]="trackingObj" [entreg]="entregTracking"></app-info-rastreio-detalhado>

        </app-cards>
    </div>

    <!--
Exibir = 6
Controle do Atendimento
 -->
    <div *ngIf="exibir == 6 && modalAtendimento == false">
        <app-cards titleDrop="Detalhes do Atendimento" [isCollapsed]="collapsed" [dropdown]="true">

            <button type="button" class="btn btn-success align-right" (click)="criarNovoAtendimento(rowSelectedGrid)" style="margin-bottom: 15px">Novo Atendimento</button>

            <app-novo-atendimento [IDA001]="IDA001_selected" [IDG043]="IDG043_selecionada" [IDG083]="IDG083_selecionada" (callListAtendimentos)="backToAtendimento()" [validaSyngenta]="validSyngenta">
            </app-novo-atendimento>

        </app-cards>

        <br />
        <!--  -->
        <app-cards titleDrop="Movimentações do Atendimento" [isCollapsed]="collapsed" [dropdown]="true">
            <app-atendimento-movs [IDA001]="IDA001_selected" (callListAtendimentos)="backToAtendimento()">
            </app-atendimento-movs>
        </app-cards>

        <app-cards titleDrop="Informações" [isCollapsed]="collapsed" [dropdown]="true">

            <ngx-loading [show]="loading"></ngx-loading>

            <app-info-rastreio #componentRastreio [objRastreio]="rastreioObj" [validaMilestone]="objValidaMilestone" resumido="true" [arCanhoto]="arCanhoto"></app-info-rastreio>

            <app-info-nfe [objNotaFiscal]="nfeObj"></app-info-nfe>

            <app-info-cte [objCTE]="cteObj"></app-info-cte>

            <app-info-carga [objCarga]="cargaObj"></app-info-carga>

            <app-info-rastreio-detalhado [objTracking]="trackingObj" [entreg]="entregTracking"></app-info-rastreio-detalhado>

        </app-cards>
    </div>

    <div *ngIf="exibir == 7 && modalAtendimento == false">
        <app-cards titleDrop="Inserir Motivo" [isCollapsed]="collapsed" [dropdown]="true">

            <app-inserir-motivo (callHome)="backHome()" (movAtendimentoEvent)="movAtendimento($event)" [IDG043]="IDG043_selecionada">
            </app-inserir-motivo>

        </app-cards>

        <app-cards titleDrop="Informações" [isCollapsed]="collapsed" [dropdown]="true">

            <ngx-loading [show]="loading"></ngx-loading>

            <app-info-rastreio #componentRastreio [objRastreio]="rastreioObj" [validaMilestone]="objValidaMilestone" resumido="true" [arCanhoto]="arCanhoto"></app-info-rastreio>

            <app-info-nfe [objNotaFiscal]="nfeObj"></app-info-nfe>

            <app-info-cte [objCTE]="cteObj"></app-info-cte>

            <app-info-carga [objCarga]="cargaObj"></app-info-carga>

            <app-info-rastreio-detalhado [objTracking]="trackingObj" [entreg]="entregTracking"></app-info-rastreio-detalhado>

        </app-cards>
    </div>

</div>
<div *ngIf="modalAtendimento" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; background: #F5F5F5; z-index: 1000; padding: 40px;">
    <div>        
        <div style="display: flex; flex-direction: row; justify-content: space-between; align-items: center;">
            <h3 class="mt-0 mb-0 text-uppercase" style="margin-left: 10px !important;"><small class="fw-300"><strong>Atendimentos / Ocorrências</strong></small></h3>
            <button type="button" class="close" aria-label="Close" (click)="closeModalAtendimento()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div>
            <app-cards titleDrop="Listagem de atendimentos">
                <app-datagrid [id]="'gridAtendimentosCriados'" [url]="url+'mo/atendimentos/listarByNfe'" [tela]="42" [telaGlobal]="
                    [
                        {'id' : 24,'metodo' : 'criarAtendimento',      'icone': 'fa fa-plus'},
                        {'id' : 'colvis'}
                    ]" [telaAcoes]="arrayBotoes" [nivel]="0" [thisParent]="this" [notOnLoad]="true" [initComplete]="'filtrarAtendimentoByNfe'" (respostaFilho)="recebeEmit($event)" [scroll]="500">
                    <th data-id="IDA001" data-type-column="actions">Ações</th>
                    <th data-id="IDA001" data-align-right="true">Id</th>
                    <th data-id="NUMNOTA" data-align-right="true" data-function="controlViewGrid" data-function-full="true">Nº NF</th>
                    <th data-id="A008_DSACAO" data-align-left="true">Ação</th>
                    <th data-id="S001_NMUSUARI" data-align-left="true">Atendente</th>
                    <th data-id="A002_DSTPMOTI" data-align-left="true">Título</th>
                    <th data-id="A006_DSSITUAC" data-align-left="true">Situação</th>
                    <th data-id="DTREGIST">Abertura</th>
                    <th data-id="DTFIM">Fechamento</th>
                    <th data-id="TEMPO">Tempo</th>
                </app-datagrid>
            </app-cards>
        </div>
        <div *ngIf="exibir == 5">
            <app-cards titleDrop="Cadastro de Atendimento" [isCollapsed]="collapsed" [dropdown]="true">
    
                <app-novo-atendimento (callListAtendimentos)="backToAtendimento()" (movAtendimentoEvent)="movAtendimento($event)" [IDG043]="IDG043_selecionada" [IDG051]="IDG051_selecionada" [IDG046]="IDG046_selecionada" [IDG083]="IDG083_selecionada" [validaSyngenta]="validSyngenta" [ultCarga]="ultCarga_selecionada">
                </app-novo-atendimento>
    
            </app-cards>
        </div>
        <div *ngIf="exibir == 6">
            <app-cards titleDrop="Detalhes do Atendimento" [isCollapsed]="collapsed" [dropdown]="true">
    
                <button type="button" class="btn btn-success align-right" (click)="criarNovoAtendimento(rowSelectedGrid)" style="margin-bottom: 15px">Novo Atendimento</button>
    
                <app-novo-atendimento [IDA001]="IDA001_selected" [IDG043]="IDG043_selecionada" [IDG083]="IDG083_selecionada" (callListAtendimentos)="backToAtendimento()" [validaSyngenta]="validSyngenta">
                </app-novo-atendimento>
    
            </app-cards>
    
            <br />
            <!--  -->
            <app-cards titleDrop="Movimentações do Atendimento" [isCollapsed]="collapsed" [dropdown]="true">
                <app-atendimento-movs [IDA001]="IDA001_selected" (callListAtendimentos)="backToAtendimento()">
                </app-atendimento-movs>
            </app-cards>
        </div>
        
        <div *ngIf="exibir == 7">
            <app-cards titleDrop="Inserir Motivo" [isCollapsed]="collapsed" [dropdown]="true">
    
                <app-inserir-motivo (callHome)="backHome()" (movAtendimentoEvent)="movAtendimento($event)" [IDG043]="IDG043_selecionada">
                </app-inserir-motivo>
    
            </app-cards>
    
            <app-cards titleDrop="Informações" [isCollapsed]="collapsed" [dropdown]="true">
    
                <ngx-loading [show]="loading"></ngx-loading>
    
                <app-info-rastreio #componentRastreio [objRastreio]="rastreioObj" [validaMilestone]="objValidaMilestone" resumido="true" [arCanhoto]="arCanhoto"></app-info-rastreio>
    
                <app-info-nfe [objNotaFiscal]="nfeObj"></app-info-nfe>
    
                <app-info-cte [objCTE]="cteObj"></app-info-cte>
    
                <app-info-carga [objCarga]="cargaObj"></app-info-carga>
    
                <app-info-rastreio-detalhado [objTracking]="trackingObj" [entreg]="entregTracking"></app-info-rastreio-detalhado>
    
            </app-cards>
        </div>
    </div>
</div>

